---
title: 'Running Evaluators'
description: 'Learn how to run multiple evaluators simultaneously'
---

# Running using Voice Calls

Run multiple evaluators at once and receive their execution details.

## API Endpont

| Method | Endpoint |
|--------|----------|
| `POST` | `https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/` |

## Authentication

Include your API key in the request headers:

| Header | Description |
|--------|-------------|
| `X-VOCERA-API-KEY` | Your API key obtained from the dashboard |

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `scenarios` | array\|string\|integer | Yes | Array of evaluator IDs to run OR `"all"` to run all OR number to run first N evaluators |
| `agent_id` | integer | Yes | Required only when `scenarios` is `"all"` OR is number of first N evaluators |

### Example Request Body
Running evaluators using ids
```json
{
    "scenarios": [201, 187]
}
```

Running all evaluators
```json
{
    "agent_id": 1,
    "scenarios": "all"
}
```

Running first N evaluators
```json
{
    "agent_id": 1,
    "scenarios": 10
}
```

## Response

A successful request returns details about created result.

### Response Fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | integer | The result ID |
| `agent` | integer | ID of associated agent |
| `status` | string | Status of the result, can be one of:<br/>• `running` - Initial state when evaluator starts<br/>• `in_progress` - Call is currently executing<br/>• `completed` - Call has finished successfully<br/>• `failed` - Call encountered an error<br/>• `pending` - Testing agent is waiting to be called |
| `success_rate` | float | Percentage of runs that passed |
| `run_as_text` | boolean | If executed as text (llm websocket) or not |

### Example Response

```json
{
    "id": 188,
    "agent": 1,
    "status": "running",
    "success_rate": 0,
    "run_as_text": false
}
```

## Code Examples

<CodeGroup>

```bash Curl
# Running using evaluator IDs
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{"scenarios": [<evaluator-id-1>, <evaluator-id-2>, ...]}'

# Running all evaluators
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{
    "scenarios": "all",
    "agent_id": <agent-id>
  }'

# Running first N evaluators
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{
    "scenarios": <number-of-evaluators>,
    "agent_id": <agent-id>
  }'
```

```python Python
def run_evaluators(api_key, evaluators, agent_id=None):
    url = 'https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/'

    headers = {
        'X-VOCERA-API-KEY': api_key,
        'Content-Type': 'application/json'
    }

    data = {
        'scenarios': evaluators
    }

    if isinstance(evaluators, (int, str)):
        if agent_id is None:
            raise ValueError("`agent_id` is required when evaluators is int or str")

        data["agent_id"] = agent_id

    response = requests.post(url, headers=headers, json=data)
    return response.json()
```

```javascript JavaScript
async function runEvaluators(apiKey, evaluators, agentId=null) {
  const url = 'https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios/';

  const data = {
    scenarios: evaluators
  }

  if (typeof evaluators === 'number' || typeof evaluators === 'string') {
    if (!agentId) {
      throw new Error('`agentId` is required when evaluators is number or string');
    }
    data.agent_id = agentId;
  }

  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'X-VOCERA-API-KEY': apiKey
    },
    body: JSON.stringify(data)
  });

  return await response.json();
}
```

</CodeGroup>


# Running using LLM Websocket
Run multiple evaluators at once using your LLM websocket and receive their execution details.

You need to add the url to your LLM websocket in your agent at Vocera.
For demo websocket server you can use [wss://echo.websocket.org](wss://echo.websocket.org) or install using [this repo](https://github.com/vocera-ai/llm-websocket-server-example).

| Method | Endpoint |
|--------|----------|
| `POST` | `https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/` |

## Authentication

Include your API key in the request headers:

| Header | Description |
|--------|-------------|
| `X-VOCERA-API-KEY` | Your API key obtained from the dashboard |

## Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `scenarios` | array\|string\|integer | Yes | Array of evaluator IDs to run OR `"all"` to run all OR number to run first N evaluators |
| `agent_id` | integer | Yes | Required only when `scenarios` is `"all"` OR is number of first N evaluators |

### Example Request Body
Running evaluators using ids
```json
{
    "scenarios": [201, 187]
}
```

Running all evaluators
```json
{
    "agent_id": 1,
    "scenarios": "all"
}
```

Running first N evaluators
```json
{
    "agent_id": 1,
    "scenarios": 10
}
```

## Response

A successful request returns details about the running evaluators.

### Response Fields

| Field | Type | Description |
|-------|------|-------------|
| `id` | integer | The result ID |
| `agent` | integer | ID of associated agent |
| `status` | string | Status of the result, can be one of:<br/>• `running` - Initial state when evaluator starts<br/>• `in_progress` - Call is currently executing<br/>• `completed` - Call has finished successfully<br/>• `failed` - Call encountered an error<br/>• `pending` - Testing agent is waiting to be called |
| `success_rate` | float | Percentage of runs that passed |
| `run_as_text` | boolean | If executed as text (llm websocket) or not |

### Example Response

```json
{
    "id": 189,
    "agent": 1,
    "status": "running",
    "success_rate": 0,
    "run_as_text": true
}
```

## WebSocket Message Format

Messages exchanged through the LLM WebSocket connection follow two main formats: normal messages and function calls.

### Message Types

#### Normal Messages
Simple text messages exchanged between the client and server.

| Field | Type | Description |
|-------|------|-------------|
| `content` | string | The text message content |

```json
{
  "content": "Hello! How can I help you today?"
}
```

#### Function Messages
Messages related to function execution, including both calls and results.

| Field | Type | Description |
|-------|------|-------------|
| `role` | string | Message type: `Function Call` or `Function Call Result` |
| `data` | object | Function-specific information (see below) |

**Function Call Data Fields:**
| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Unique identifier for the function call |
| `name` | string | Name of the function being called |
| `arguments` | string | JSON-encoded function arguments |

**Function Result Data Fields:**
| Field | Type | Description |
|-------|------|-------------|
| `id` | string | Matching identifier from the function call |
| `name` | string | Name of the executed function |
| `result` | string | Function execution result or error message |

### Examples

**Function Call:**
```json
{
    "role": "Function Call",
    "data": {
        "id": "call_5otWH44dxeXEHY8RlhYYaFbV",
        "name": "bookUserAppointment",
        "arguments": "{\"name\": \"John\", \"datetime\": \"2024-10-17T18:00:00\"}"
    }
}
```

**Function Result:**
```json
{
    "role": "Function Call Result",
    "data": {
        "id": "call_5otWH44dxeXEHY8RlhYYaFbV",
        "name": "bookUserAppointment",
        "result": "Appointment successfully booked"
    }
}
```

## Code Examples

<CodeGroup>

```bash Curl
# Running using evaluator IDs
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{"scenarios": [<evaluator-id-1>, <evaluator-id-2>, ...]}'

# Running all evaluators
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{
    "scenarios": "all",
    "agent_id": <agent-id>
  }'

# Running first N evaluators
curl -X POST https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/ \
  -H "X-VOCERA-API-KEY: <your-api-key-here>" \
  -H "Content-Type: application/json" \
  -d '{
    "scenarios": <number-of-evaluators>,
    "agent_id": <agent-id>
  }'
```

```python Python
def run_evaluators(api_key, evaluators, agent_id=None):
    url = 'https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/'

    headers = {
        'X-VOCERA-API-KEY': api_key,
        'Content-Type': 'application/json'
    }

    data = {
        'scenarios': evaluators
    }

    if isinstance(evaluators, (int, str)):
        if agent_id is None:
            raise ValueError("`agent_id` is required when evaluators is int or str")

        data["agent_id"] = agent_id

    response = requests.post(url, headers=headers, json=data)
    return response.json()
```

```javascript JavaScript
async function runEvaluators(apiKey, evaluators, agentId=null) {
  const url = 'https://new-prod.vocera.ai/test_framework/v1/scenarios-external/run_scenarios_text/';

  const data = {
    scenarios: evaluators
  }

  if (typeof evaluators === 'number' || typeof evaluators === 'string') {
    if (!agentId) {
      throw new Error('`agentId` is required when evaluators is number or string');
    }
    data.agent_id = agentId;
  }

  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'X-VOCERA-API-KEY': apiKey
    },
    body: JSON.stringify(data)
  });

  return await response.json();
}
```

</CodeGroup>
