---
title: "Metric Lab"
sidebarTitle: "Metric Lab"
icon: "flask"
iconType: "regular"
description: "Metric Lab is a tool that allows you to create and manage custom metrics for your AI agents."
---
<iframe
  width="100%"
  height="400px"
  style={{
    aspectRatio: "16 / 9",
    border: "1px solid #ccc",
    borderRadius: "8px",
    marginBottom: "20px",
  }}
  src="https://www.tella.tv/video/cm7vbj9p0001k0ajo6ex71u1o/embed"
  frameborder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
  allowfullscreen
  title="Metric Lab Overview"
/>

## Advanced Features of Metric Lab

Metric Lab provides powerful tools for defining, testing, and optimizing custom metrics for your AI assistant. This guide walks you through the process of refining metrics to ensure they accurately reflect real-world performance.

## Metric Optimization Workflow

Metric Lab provides a powerful workflow for defining, testing, and automatically optimizing custom metrics to ensure they accurately reflect your AI assistant's performance.


### Defining Custom Metrics

First, define a custom metric tailored to your specific business logic. In this example, we will create a metric to verify appointment bookings.

*   **Metric Name**: Appointment Booked
*   **Definition**: Assesses whether the main agent successfully booked an appointment for the testing agent.
*   **Success Criteria**: An appointment was successfully booked.
*   **Failure Criteria**: No appointment was booked, or the process was incomplete.

<img src="/images/metriclab/1-define-metric.png" alt="Defining Custom Metric" className="rounded-md"/>

### Identifying Metric Performance Issues

After your agent runs, you might notice discrepancies where the metric result doesn't match reality.

*   **False Positive**: The metric says "Appointment Booked" (Success), but the agent actually failed to confirm the time.

*   **False Negative**: The metric says "Not Booked" (Failure), even though the agent successfully completed the booking.

These inconsistencies are signals that your metric definition (prompt or code) needs refinement.


### Add to Labs

To fix these issues, you need to create a test set from these problematic calls.

*   Locate the specific calls in your logs where the metric failed.
*   Select them and click **Add to Lab**.
*   Assign them to the "Appointment Booked" metric lab.

<img src="/images/metriclab/2-add-to-lab.png" alt="Add to Labs" className="rounded-md"/>


### Initial Run

Once inside the Lab, run your current metric against the newly added test set to establish a baseline.

*   Click the **Run** button in the Metric Lab.
*   The system will evaluate the "Appointment Booked" metric against all the calls in your test set.
*   Review the **Overall Score** (e.g., 3/5) to see the current accuracy.

<img src="/images/metriclab/3-initial-run.png" alt="Initial Run" className="rounded-md"/>


### Annotate
This is the most critical step. You must tell the system what the *correct* result should have been for each failed call.

*   Scroll down to the **Table View**.
*   Look for rows where **Actual Value** (what the metric thought) differs from what really happened.
*   **Update Expected Value**: Change the expected status to the correct one (e.g., change "False" to "True" if it was actually booked).
*   **Add Notes**: Click the feedback/notes icon and explain *why* the metric was wrong (e.g., "The user implicitly confirmed the time by saying 'Sounds good', so this should count as a booking").

<img src="/images/metriclab/4-annotate.png" alt="Annotate and Add Notes" className="rounded-md"/>


### Auto Improve

Instead of rewriting the prompt manually, let the Metric Lab's optimizer do the work for you.

*   Ensure you have annotated the mismatches and added notes.
*   Click the **Auto Improve** button at the top right.
*   The system will analyze the transcripts, your notes, and the expected outcomes to generate a better metric definition.

<img src="/images/metriclab/5-auto-improve.jpg" alt="Auto Improve Button" className="rounded-md"/>


### View, Analyze and Save

Once the Auto Improve task is complete (indicated by a green checkmark in the progress panel), you can review what the system proposes. Verify that the changes make sense and align with your meaningful definition of the metric.

*   Click **View Changes** on the completed task.
*   **Diff View**: Inspect the highlighted changes in the **Description** or **Prompt** fields. You might see that the system added specific instructions like "Consider 'Sounds good' as a valid confirmation."
*   **Review Table**: Scan the table to ensure the new logic fixes the previous errors without breaking correct rows.
*   Click **Save** to apply the optimized metric definition.

<img src="/images/metriclab/6-view-analyze-save.png" alt="Analyze Diff and Save" className="rounded-md"/>


### Re-run and Observe Improvement

Finally, verify that your new metric is robust.

*   The metric is now updated with the optimized logic.
*   Future calls will be evaluated using this smarter definition.
*   You can manually **Run** the review again to confirm the score remains high (e.g., 5/5).


## Benefits of Metric Optimization

This iterative optimization process allows you to:

- Improve metric accuracy from as low as 50% to 95% or higher
- Ensure the labels you see from your AI assistant accurately reflect real performance
- Make data-driven decisions based on reliable metrics